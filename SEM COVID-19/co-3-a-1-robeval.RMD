---
title: "COVID-19 Model Iteration 3-a-1 Robustness Evaluation"
output: html_document
---

```{r setup, echo =FALSE, include=FALSE}
# Include libraries
library(tidyverse)
library(seminr)
library(DT)
library(htmltools)
library(lmtest)
# Load models and create summaries
# Load PLS Model
model <- readRDS("Models/model-co-3-a-1.RDS")
bootmodel <- readRDS("Models/model-boot-co-3-a-1.RDS")
# Load bootstrapped first stage PLS model
bootfsmodel <- readRDS("Models/model-fs-boot-co-3-a-1.RDS")
# Load approximation PLS model (no HOCs, data formatted as data.frame)
proxymodel <- readRDS("Models/model-proxy-co-3-a-1.RDS")
summo <- summary(model)
sumfs <- summary(model$first_stage_model)
sumbomo <- summary(bootmodel)
sumbofsmo <- summary(bootfsmodel)
# Set seminr plot theme
thm <- seminr_theme_create(construct.compositeA.arrow = "backward", construct.compositeA.use_weights = FALSE, plot.adj = FALSE)
seminr_theme_set(thm)
# My favorite operator
`%notin%` <- Negate(`%in%`)
```

# Nonlinearity
If any of the test statistics is significant, the respective regression equation might be nonlinear.
```{r reset}
# summo$paths
#lmbi <- lm(model$construct_scores[,6] ~ model$construct_scores[,3] + model$construct_scores[,4] + model$construct_scores[,5])
lmbi1 <- lm(model$data[,1] ~ model$data[,c(23:29,32:34,38:39)])
lmbi2 <- lm(model$data[,2] ~ model$data[,c(23:29,32:34,38:39)])
lmbi3 <- lm(model$data[,3] ~ model$data[,c(23:29,32:34,38:39)])
lmpre1 <- lm(model$data[,"CORB4"] ~ model$data[,c(6:14,41)])
lmpre2 <- lm(model$data[,"CORB5"] ~ model$data[,c(6:14,41)])
lmpre3 <- lm(model$data[,"CORB6"] ~ model$data[,c(6:14,41)])
lmprc1 <- lm(model$data[,"CORB7"] ~ model$data[,c(6:14)])
lmprc2 <- lm(model$data[,"CORB8"] ~ model$data[,c(6:14)])
lmprc3 <- lm(model$data[,"CORB9"] ~ model$data[,c(6:14)])
# model$mmMatrix
# model$smMatrix
# colnames(model$data)
# colnames(model$construct_scores)
resettest(lmbi1)
resettest(lmbi2)
resettest(lmbi3)
resettest(lmpre1)
resettest(lmpre2)
resettest(lmpre3)
resettest(lmprc1)
resettest(lmprc2)
resettest(lmprc3)
```
Using p = 0.05 as a threshold, there are potential nonlinear effects in the partial regression equations for Behavioral Intention (all indicators) and Perceived Response Efficacy (all but CCRB7). All test statistics for Perceived Response Costs are non-significant.
