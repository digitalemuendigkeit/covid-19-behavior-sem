---
title: "COVID-19 Model Iteration 2 Nonlinearity Evaluation"
output:
  distill::distill_article:
    toc: true
    toc_depth: 2
---

```{r setup, echo =FALSE, include=FALSE}
# Include libraries
library(tidyverse)
library(seminr)
library(DT)
library(htmltools)
library(lmtest)
library(distill)
source(here::here("helpers.R"))
# Load models and create summaries
# Load PLS Model
model <- readRDS("Models/model-co-2.RDS")
bootmodel <- readRDS("Models/model-boot-co-2.RDS")
# Load bootstrapped first stage PLS model
bootfsmodel <- readRDS("Models/model-fs-boot-co-2.RDS")
# Load approximation PLS model (no HOCs, data formatted as data.frame)
proxymodel <- readRDS("Models/model-proxy-co-2.RDS")
summo <- summary(model)
sumfs <- summary(model$first_stage_model)
sumbomo <- summary(bootmodel)
sumbofsmo <- summary(bootfsmodel)
sumprmo <- summary(proxymodel)
# Bootstrap proxy model (500 samples) for comparability
bootprmodel <- bootstrap_model(proxymodel)
sumboprmo <- summary(bootprmodel)
# Set seminr plot theme
thm <- seminr_theme_create(construct.compositeA.arrow = "backward", construct.compositeA.use_weights = FALSE, plot.adj = FALSE)
seminr_theme_set(thm)
# My favorite operator
`%notin%` <- Negate(`%in%`)
```

# Test for possible nonlinearity

First, we test for nonlinearity by applying Ramsey's RESET test for functional form to each partial linear model of the SEM.
As quadratic effects of higher-order constructs cannot (yet) be estimated using PLS-SEM, we also apply the test to the corresponding partial linear models of the proxy SEM without higher order constructs.
If the test statistic is significant, the respective partial regression might be nonlinear.

```{r reset, echo = FALSE}
# Make df with independent and response variable
varlist <- as_tibble(model$smMatrix)
# Make df
resetdf <- data.frame(
  'Independent variable' = character(),
  'Response variable' = character(),
  'Test statistic' = double(),
  'p' = double(),
  'DF 1' = double(),
  'DF 2' = double()
)
# Fill df
for (i in 1:nrow(varlist)) {
  resetdf <- resetdf %>% rbind(resetfun(varlist[[i, 1]],
                                        varlist[[i, 2]]))
}
resetdf %>%
  datatable(
    rownames = FALSE,
    caption = 'Results of Ramsey\'s RESET test for nonlinearity') %>%
  formatRound(c(3:4),
              3)
```
Using p = 0.05 as a threshold, there are potential nonlinear effects in the partial regression equations for the influence of Response Beliefs, Threat Beliefs, and Subjective Norm on Behavioral Intention.
The same is potentially true for the effects of Distrusting Beliefs and Knowledge on Response Beliefs, and for the effects of Distrusting Beliefs and Knowledge on Threat Beliefs.

# Test alternate models with quadratic effects
To test for nonlinearity, one can model an interaction term of the exogenous construct with itself.

## Effect of Response Beliefs on Behavioral Intention
```{r bi1 alt nonlinear estimate, echo = FALSE, include = FALSE}
# Estimate alternate model with quadratic effect - HOCs as proxy
mobi1alt <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Response Beliefs 1", multi_items("CORB", c(4:10)), weights = mode_B),
    composite("Response Beliefs 2", multi_items("CORB", c(4:10)), weights = mode_B),
    interaction_term("Response Beliefs 1", "Response Beliefs 2", method = two_stage),
    # composite("Benevolence", multi_items("CODI", 1:3)),
    # composite("Competence", multi_items("CODI", 4:6)),
    # composite("Integrity", multi_items("CODI", 7:9)),
    # higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Distrusting Beliefs", multi_items("CODI", 1:9), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    # composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    # composite("Perceived Severity", multi_items("COTB", 4:6)),
    # higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Threat Beliefs", multi_items("COTB", 1:6), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    # composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    # composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    # higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Subjective Norm", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(
      from = c("Distrusting Beliefs", "Knowledge"),
      to = c("Response Beliefs 1",
              "Response Beliefs 2", 
             "Threat Beliefs")
    ),
    paths(
      from = c(
        "Response Beliefs 1*Response Beliefs 2",
        "Threat Beliefs",
        "Personal Moral Norm",
        "Subjective Norm"
      ),
      to = "Behavioral Intention"
    )
  )
)
# Estimate second model for f2 with construct excluded
mobi1altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs", "Knowledge"), to = c("Threat Beliefs")),
    paths(from = c("Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
sumbomobi1alt <- mobi1alt %>%
  bootstrap_model() %>%
  summary()
```
```{r bi1 alt results, echo = FALSE}
# Print datatable
nldfdt("Response Beliefs",
     "Behavioral Intention",
     mobi1alt,
     mobi1altex,
     sumbomobi1alt)
```

For the alternate model with Response Beliefs as a quadratic influence, the effect size is smaller, as well as the t-value.
This points to a linear effect of Response Beliefs on Behavioral Intention.

## Effect of Threat Beliefs on Behavioral Intention

```{r bi2 alt nonlinear estimate, echo = FALSE, include = FALSE}
# Estimate alternate model with quadratic effect - HOCs as proxy
mobi2alt <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    # composite("Perceived Self-Efficacy", single_item("CORB10")),
    # composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    # composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    # higher_composite(
    #   "Response Beliefs",
    #   c(
    #     "Perceived Self-Efficacy",
    #     "Perceived Response Efficacy",
    #     "Perceived Response Costs"
    #   ),
    #   weights =  mode_B
    # ),
    composite("Response Beliefs", multi_items("CORB", 4:10), mode_B),
    # composite("Benevolence", multi_items("CODI", 1:3)),
    # composite("Competence", multi_items("CODI", 4:6)),
    # composite("Integrity", multi_items("CODI", 7:9)),
    # higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Distrusting Beliefs", multi_items("CODI", 1:9), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Threat Beliefs 1", multi_items("COTB", 1:6), weights = mode_B),
    composite("Threat Beliefs 2", multi_items("COTB", 1:6), weights = mode_B),
    interaction_term("Threat Beliefs 1", "Threat Beliefs 2", method = two_stage),
    composite("Personal Moral Norm", multi_items("COPN", c(1, 3))),
    # composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    # composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    # higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Subjective Norm", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(
      from = c("Distrusting Beliefs", "Knowledge"),
      to = c("Response Beliefs", "Threat Beliefs 1", "Threat Beliefs 2")
    ),
    paths(
      from = c(
        "Response Beliefs",
        "Threat Beliefs 1*Threat Beliefs 2",
        "Personal Moral Norm",
        "Subjective Norm"
      ),
      to = "Behavioral Intention"
    )
  )
)
# Estimate second model for f2 with construct excluded
mobi2altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite(
      "Response Beliefs",
      c(
        "Perceived Self-Efficacy",
        "Perceived Response Efficacy",
        "Perceived Response Costs"
      ),
      weights =  mode_B
    ),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite(
      "Distrusting Beliefs",
      c("Benevolence", "Competence", "Integrity"),
      weights = mode_B
    ),
    composite("Knowledge", single_item("COKN")),
    composite("Personal Moral Norm", multi_items("COPN", c(1, 3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite(
      "Subjective Norm",
      c("Descriptive Norm", "Injunctive Norm"),
      weights = mode_B
    ),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(
      from = c("Distrusting Beliefs", "Knowledge"),
      to = c("Response Beliefs")
    ),
    paths(
      from = c("Response Beliefs", "Personal Moral Norm", "Subjective Norm"),
      to = "Behavioral Intention"
    )
  )
)
# Bootstrap model for significance (500 samples)
sumbomobi2alt <- mobi2alt %>%
  bootstrap_model() %>%
  summary()
```
```{r bi2 alt results, echo = FALSE}
# Assess impact using f² and significance
nldfdt("Threat Beliefs",
     "Behavioral Intention",
     mobi2alt,
     mobi2altex,
     sumbomobi2alt)
```

For the alternate model with Threat Beliefs as a quadratic influence, the effect size is smaller, as is the t-value.
This points to a linear effect of Threat Beliefs on Behavioral Intention.

## Effect of Subjective Norm on Behavioral Intention

```{r bi3 alt nonlinear estimate, echo = FALSE, include = F}
# Estimate alternate model with quadratic effect (HOCs as proxy)
# two-stage approach would be correct but does not work
# use orthogonal and product indicator to find influence
mobi3altortmm <- constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Subjective Norm 1", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), mode_B),
    composite("Subjective Norm 2", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), mode_B),
    interaction_term("Subjective Norm 1", "Subjective Norm 2", method = orthogonal),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  )
mobi3altpimm <- constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Subjective Norm 1", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), mode_B),
    composite("Subjective Norm 2", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), mode_B),
    interaction_term("Subjective Norm 1", "Subjective Norm 2", method = product_indicator),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  )
mobi3altsm <- relationships(
    paths(from = c("Distrusting Beliefs", "Knowledge"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm 1*Subjective Norm 2"), to = "Behavioral Intention"))
mobi3altort <- estimate_pls(as.data.frame(model$data), mobi3altortmm, mobi3altsm)
mobi3altpi <- estimate_pls(as.data.frame(model$data), mobi3altpimm, mobi3altsm)
# mobi3alt <- estimate_pls(
#   data = model$data,
#   measurement_model = constructs(
#     composite("Response Beliefs", multi_items("CORB", 4:10), mode_B),
#     composite("Distrusting Beliefs", multi_items("CODI", 1:9), weights = mode_B),
#     composite("Knowledge", single_item("COKN")),
#     composite("Threat Beliefs", multi_items("COTB", 1:6), weights = mode_B),
#     composite("Personal Moral Norm", multi_items("COPN", c(1, 3))),
#     composite("Subjective Norm 1", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), weights = mode_B),
#     composite("Subjective Norm 2", c(multi_items("CODN", 1:2), multi_items("COIN", 1:2)), weights = mode_B),
#     interaction_term("Subjective Norm 1", "Subjective Norm 2", method = two_stage),
#     composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
#   ),
#   structural_model = relationships(
#     paths(
#       from = c("Distrusting Beliefs", "Knowledge"),
#       to = c("Response Beliefs", "Threat Beliefs")
#     ),
#     paths(
#       from = c(
#         "Response Beliefs",
#         "Threat Beliefs",
#         "Personal Moral Norm",
#         "Subjective Norm 1*Subjective Norm 2"
#       ),
#       to = "Behavioral Intention"
#     )
#   )
# )
# Estimate second model for f2 with construct excluded
mobi3altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs", "Knowledge"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Personal Moral Norm", "Threat Beliefs"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
bommobi3altort <- bootstrap_model(mobi3altort)
sumbomobi3altort <- summary(bommobi3altort)
bommobi3altpi <- bootstrap_model(mobi3altpi)
sumbomobi3altpi <- summary(bommobi3altpi)
```
```{r bi3 alt nonlinear assess, echo = FALSE}
# Assess impact using f² and significance
bi3ort <- nldf("Subjective Norm",
              "Behavioral Intention",
              mobi3altort,
              mobi3altex,
              sumbomobi3altort)
bi3ort[3,3] <- "Quadratic Orthogonal"
bi3pia <- nldf("Subjective Norm",
              "Behavioral Intention",
              mobi3altpi,
              mobi3altex,
              sumbomobi3altpi)
bi3pia[3,3] <- "Quadratic Product-Indicator"
bi3ort %>% 
  union(
  bi3pia
) %>%
  datatable(rownames = FALSE,
                     caption = "Comparative effects of Subjective Norm on Behavioral Intention") %>% 
    formatRound(c(4:5),
               digits = 3)
```
The Subjective Norm alternative model can only be assessed using the orthogonal and product-indicator approach, although the two-stage approach would be methodically correct.
Neither of those alternate approaches shows a significant effect of a Subjective Norm quadratic term.
This points to a linear effect of Subjective Norm on Behavioral Intention.

## Effect of Distrusting Beliefs on Response Beliefs

```{r rb1 alt nonlinear estimate, echo = F, include = F}
# Estimate alternate model with quadratic effect - HOCs as proxy
# Again, two-stage, though correct, does not work -> use ort and pi
morb1altort <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Distrusting Beliefs 1", multi_items("CODI", 1:9), weights = mode_B),
    composite("Distrusting Beliefs 2", multi_items("CODI", 1:9), weights = mode_B),
    interaction_term("Distrusting Beliefs 1", "Distrusting Beliefs 2", method = orthogonal),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs 1*Distrusting Beliefs 2", "Knowledge"), to = c("Response Beliefs")),
    paths(from = c("Distrusting Beliefs 1", "Knowledge"), to = c("Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
morb1altpi <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Distrusting Beliefs 1", multi_items("CODI", 1:9), weights = mode_B),
    composite("Distrusting Beliefs 2", multi_items("CODI", 1:9), weights = mode_B),
    interaction_term("Distrusting Beliefs 1", "Distrusting Beliefs 2", method = product_indicator),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs 1*Distrusting Beliefs 2", "Knowledge"), to = c("Response Beliefs")),
    paths(from = c("Distrusting Beliefs 1", "Knowledge"), to = c("Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Estimate second model for f2 with construct excluded
morb1altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Knowledge"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
bomorb1altort <- bootstrap_model(morb1altort)
sumbomorb1altort <- summary(bomorb1altort)
bomorb1altpi <- bootstrap_model(morb1altpi)
sumbomorb1altpi <- summary(bomorb1altpi)
```
```{r rb1 results, echo = F}
# Assess impact using f² and significance
rb1ort <- nldf("Distrusting Beliefs",
              "Response Beliefs",
              morb1altort,
              morb1altex,
              sumbomorb1altort)
rb1ort[3,3] <- "Quadratic Orthogonal"
rb1pia <- nldf("Distrusting Beliefs",
              "Response Beliefs",
              morb1altpi,
              morb1altex,
              sumbomorb1altpi)
rb1pia[3,3] <- "Quadratic Product-Indicator"
rb1ort %>% 
  union(
  rb1pia
) %>%
  datatable(rownames = FALSE,
                     caption = "Comparative effects of Distrusting Beliefs on Response Beliefs") %>% 
    formatRound(c(4:5),
               digits = 3)
```
The Distrusting Beliefs - Response Beliefs alternative model can only be assessed using the orthogonal and product-indicator approach, although the two-stage approach would be methodically correct.
The product-indicator approach produces a significant effect for the quadratic term, however, it is smaller and less significant than the effects of the linear term in both the original and the proxy SEM.
This points to a linear effect of Distrusting Beliefs on Response Beliefs.

## Effect of Knowledge on Response Beliefs

```{r rb2 alt nonlinear estimate, echo = F, include = F}
# Estimate alternate model with quadratic effect - HOCs as proxy
morb2alt <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge1", single_item("COKN")),
    composite("Knowledge2", single_item("COKN")),
    interaction_term("Knowledge1", "Knowledge2", method = orthogonal),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs", "Knowledge1*Knowledge2"), to = c("Response Beliefs")),
    paths(from = c("Distrusting Beliefs", "Knowledge1"), to = c("Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Estimate second model for f2 with construct excluded
morb2altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
bomorb2alt <- bootstrap_model(morb2alt)
sumbomorb2alt <- summary(bomorb2alt)
```
```{r rb2 alt results, echo=FALSE}
# Assess impact using f² and significance
nldfdt("Knowledge",
     "Response Beliefs",
     morb2alt,
     morb2altex,
     sumbomorb2alt)
```
For the alternate model with Knowledge as a quadratic influence, the effect size is smaller, as well as the t-value.
This points to a linear effect of Knowledge on Response Beliefs.


## Effect of Distrusting Beliefs on Threat Beliefs

```{r tb1 alt nonlinear estimate, echo = F, include = F}
# Estimate alternate model with quadratic effect - HOCs as proxy
# Again, two-stage, though correct, does not work -> use ort and pi
motb1altort <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Distrusting Beliefs 1", multi_items("CODI", 1:9), weights = mode_B),
    composite("Distrusting Beliefs 2", multi_items("CODI", 1:9), weights = mode_B),
    interaction_term("Distrusting Beliefs 1", "Distrusting Beliefs 2", method = orthogonal),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs 1*Distrusting Beliefs 2", "Knowledge"), to = c("Threat Beliefs")),
    paths(from = c("Distrusting Beliefs 1", "Knowledge"), to = c("Response Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
motb1altpi <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Distrusting Beliefs 1", multi_items("CODI", 1:9), weights = mode_B),
    composite("Distrusting Beliefs 2", multi_items("CODI", 1:9), weights = mode_B),
    interaction_term("Distrusting Beliefs 1", "Distrusting Beliefs 2", method = product_indicator),
    composite("Knowledge", single_item("COKN")),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs 1*Distrusting Beliefs 2", "Knowledge"), to = c("Threat Beliefs")),
    paths(from = c("Distrusting Beliefs 1", "Knowledge"), to = c("Response Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Estimate second model for f2 with construct excluded
motb1altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Knowledge", single_item("COKN")),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Knowledge"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
bomotb1altort <- bootstrap_model(motb1altort)
sumbomotb1altort <- summary(bomotb1altort)
bomotb1altpi <- bootstrap_model(motb1altpi)
sumbomotb1altpi <- summary(bomotb1altpi)
```
```{r tb1 results, echo = F}
# Assess impact using f² and significance
tb1ort <- nldf("Distrusting Beliefs",
              "Threat Beliefs",
              motb1altort,
              motb1altex,
              sumbomotb1altort)
tb1ort[3,3] <- "Quadratic Orthogonal"
tb1pia <- nldf("Distrusting Beliefs",
              "Threat Beliefs",
              motb1altpi,
              motb1altex,
              sumbomotb1altpi)
tb1pia[3,3] <- "Quadratic Product-Indicator"
tb1ort %>% 
  union(
  tb1pia
) %>%
  datatable(rownames = FALSE,
                     caption = "Comparative effects of Distrusting Beliefs on Threat Beliefs") %>% 
    formatRound(c(4:5),
               digits = 3)
```
The Distrusting Beliefs - Threat Beliefs alternative model can only be assessed using the orthogonal and product-indicator approach, although the two-stage approach would be methodically correct.
Both approaches produce a significant effect for the quadratic term, however, the effect sizes are significantly smaller and less significant than the effects of the linear term in both the original and the proxy SEM.
This points to a linear effect of Distrusting Beliefs on Response Beliefs.

## Effect of Knowledge on Threat Beliefs

```{r tb2 alt nonlinear estimate, echo = F, include = F}
# Estimate alternate model with quadratic effect - HOCs as proxy
motb2alt <- estimate_pls(
  as.data.frame(model$data),
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Knowledge1", single_item("COKN")),
    composite("Knowledge2", single_item("COKN")),
    interaction_term("Knowledge1", "Knowledge2", method = orthogonal),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs", "Knowledge1*Knowledge2"), to = c("Threat Beliefs")),
    paths(from = c("Distrusting Beliefs", "Knowledge1"), to = c("Response Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Estimate second model for f2 with construct excluded
motb2altex <- estimate_pls(
  data = model$data,
  measurement_model = constructs(
    composite("Perceived Self-Efficacy", single_item("CORB10")),
    composite("Perceived Response Efficacy", multi_items("CORB", 4:6), mode_B),
    composite("Perceived Response Costs", multi_items("CORB", 7:9), mode_B),
    higher_composite("Response Beliefs", c("Perceived Self-Efficacy", "Perceived Response Efficacy", "Perceived Response Costs"), weights =  mode_B),
    composite("Perceived Susceptibility", multi_items("COTB", 1:3)),
    composite("Perceived Severity", multi_items("COTB", 4:6)),
    higher_composite("Threat Beliefs", c("Perceived Susceptibility", "Perceived Severity"), weights = mode_B),
    composite("Benevolence", multi_items("CODI", 1:3)),
    composite("Competence", multi_items("CODI", 4:6)),
    composite("Integrity", multi_items("CODI", 7:9)),
    higher_composite("Distrusting Beliefs", c("Benevolence", "Competence", "Integrity"), weights = mode_B),
    composite("Personal Moral Norm", multi_items("COPN", c(1,3))),
    composite("Descriptive Norm", multi_items("CODN", 1:2), mode_B),
    composite("Injunctive Norm", multi_items("COIN", 1:2), mode_B),
    higher_composite("Subjective Norm", c("Descriptive Norm", "Injunctive Norm"), weights = mode_B),
    composite("Behavioral Intention", multi_items("COBI", 1:3), mode_B)
  ),
  structural_model = relationships(
    paths(from = c("Distrusting Beliefs"), to = c("Response Beliefs", "Threat Beliefs")),
    paths(from = c("Response Beliefs", "Threat Beliefs", "Personal Moral Norm", "Subjective Norm"), to = "Behavioral Intention")
  )
)
# Bootstrap model for significance (500 samples)
bomotb2alt <- bootstrap_model(motb2alt)
sumbomotb2alt <- summary(bomotb2alt)
```
```{r tb2 alt results, echo=FALSE}
# Assess impact using f² and significance
nldfdt("Knowledge",
     "Threat Beliefs",
     motb2alt,
     motb2altex,
     sumbomotb2alt)
```
The effect of the quadratic term is miniscule and not significant.
This points to a linear effect of Knowledge on Threat Beliefs.

# Summary
Using the available tests, we did not find evidence for a quadratic influence of any of the exogenous variables.
